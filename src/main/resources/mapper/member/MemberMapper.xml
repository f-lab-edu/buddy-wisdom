<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="cobook.buddywisdom.member.mapper.MemberMapper">

    <insert id="createMember" parameterType="map" useGeneratedKeys="true" keyProperty="id">
        <selectKey resultType="long" keyProperty="id" order="BEFORE">
            SELECT MAX(id)+1 AS ID FROM member
        </selectKey>
        INSERT INTO member
                (id
                 , name
                 , nickname
                 , email
                 , password
                 , phone_number
                 , role
                 , active_yn
                 , created_at
                )
        VALUES (#{id}
                , #{name}
                , #{nickname}
                , #{email}
                , #{password}
                , #{phone_number}
                , #{role}
                , #{active_yn}
                , #{created_at}
            );
    </insert>

    <select id="getRoleType" parameterType="long" resultType="String">
        SELECT m.role
        FROM member m
        WHERE m.id = #{id}
          AND m.active_yn = 1
    </select>
</mapper>
